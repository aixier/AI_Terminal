import{r as e,a,c as r,o as s,b as l,d as o,w as t,e as n,f as u,u as m,g as d,E as i}from"./index-Bqi7-coL.js";import{u as p}from"./terminal-C3Bkzhzo.js";import{s as c}from"./config-BlRP1y8r.js";import{_ as g}from"./_plugin-vue_export-helper-BCo6x5W8.js";const f={class:"login-container"},_={class:"login-card"},b=g({__name:"Login",setup(g){const b=m(),w=p(),v=e(),h=e(!1),V=a({username:"",password:"",remember:!1}),y={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]},k=async()=>{if(await v.value.validate()){h.value=!0;try{const e=await c.post("/auth/login",{username:V.username,password:V.password});localStorage.setItem("token",e.data.token),V.remember&&localStorage.setItem("username",V.username),w.setUserInfo(e.data.user),i.success("登录成功"),b.push("/card-generator")}catch(e){i.error(e.message||"登录失败")}finally{h.value=!1}}},x=localStorage.getItem("username");return x&&(V.username=x,V.remember=!0),(e,a)=>{const m=u("el-input"),i=u("el-form-item"),p=u("el-checkbox"),c=u("el-button"),g=u("el-form");return s(),r("div",f,[l("div",_,[a[5]||(a[5]=l("div",{class:"login-header"},[l("h1",null,"终端控制台"),l("p",null,"请登录以继续")],-1)),o(g,{ref_key:"loginFormRef",ref:v,model:V,rules:y,class:"login-form",onSubmit:n(k,["prevent"])},{default:t(()=>[o(i,{prop:"username"},{default:t(()=>[o(m,{modelValue:V.username,"onUpdate:modelValue":a[0]||(a[0]=e=>V.username=e),placeholder:"用户名","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),o(i,{prop:"password"},{default:t(()=>[o(m,{modelValue:V.password,"onUpdate:modelValue":a[1]||(a[1]=e=>V.password=e),type:"password",placeholder:"密码","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),o(i,null,{default:t(()=>[o(p,{modelValue:V.remember,"onUpdate:modelValue":a[2]||(a[2]=e=>V.remember=e)},{default:t(()=>a[3]||(a[3]=[d("记住我",-1)])),_:1,__:[3]},8,["modelValue"])]),_:1}),o(i,null,{default:t(()=>[o(c,{type:"primary",size:"large",class:"login-button",loading:h.value,onClick:k},{default:t(()=>a[4]||(a[4]=[d(" 登录 ",-1)])),_:1,__:[4]},8,["loading"])]),_:1})]),_:1},8,["model"]),a[6]||(a[6]=l("div",{class:"login-footer"},[l("p",null,"默认账号：admin / admin123")],-1))])])}}},[["__scopeId","data-v-d69c0527"]]);export{b as default};
