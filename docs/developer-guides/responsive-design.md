# 🚀 AI Terminal 渐进式响应式设计任务清单

> **方案**: 渐进式响应式适配 (Progressive Responsive Design)  
> **理念**: 增强而非重写，保持PC端体验完全不变  
> **目标**: 一套代码，多端统一体验

---

## 📱 移动端布局设计

### PC端 → 移动端功能映射
| PC端区域 | 移动端底栏Tab | 功能说明 |
|----------|--------------|---------|
| 右边栏(模板选择/输入) | 📝 **创建卡片** | 卡片创建和模板选择 |
| 左边栏(卡片列表) | 📁 **文件** | 卡片文件管理和浏览 |
| 中上区域(预览) | 👁️ **预览** | 卡片内容预览显示 |
| 中下区域(终端) | 💻 **Terminal** | 命令行终端交互 |

### 移动端布局结构
```
┌─────────────────────────────────┐
│                                 │
│         当前活跃视图              │
│     (全屏单视图显示)              │
│                                 │
│                                 │
│                                 │
│                                 │
│                                 │
├─────────────────────────────────┤
│ 📝   📁   👁️   💻  │ ← 底部Tab导航栏
│创建  文件  预览  Terminal        │   (固定60px高度)
└─────────────────────────────────┘
```

---

## 📋 任务总览

| 阶段 | 任务数 | 状态 |
|------|--------|------|
| 🏗️ 基础设施 | 6个任务 | ⏳ 待开始 |
| 📱 响应式容器 | 4个任务 | ⏳ 待开始 |
| 🎨 组件适配 | 5个任务 | ⏳ 待开始 |
| ✋ 触摸交互 | 3个任务 | ⏳ 待开始 |
| 🔧 优化完善 | 4个任务 | ⏳ 待开始 |

**总计**: 22个任务

---

## 🏗️ 阶段1: 基础设施建设

### 1.1 设计系统增强

- [ ] **任务1: 断点系统设计**
  - **文件位置**: `src/design-system/tokens/breakpoints.js`
  - **核心功能**:
    - 定义移动端断点: `mobile: '320px'`, `mobileLarge: '425px'`
    - 定义平板端断点: `tablet: '768px'`, `laptop: '1024px'`
    - 定义桌面端断点: `desktop: '1440px'`
    - 创建媒体查询对象: `media.mobile`, `media.tablet`, `media.desktop`
    - 特殊查询支持: `media.touch`, `media.hover`
    - 导出响应式工具函数: `isMobile()`, `isTablet()`, `isDesktop()`
  - **技术要求**:
    - 提供CSS变量和JavaScript API
    - 支持动态断点检测和设备类型判断
    - 与现有设计系统完全兼容
  - **验收标准**: CSS变量和JS函数可正常使用，准确识别不同设备类型

- [ ] **任务2: 响应式间距系统扩展**
  - **文件位置**: `src/design-system/tokens/spacing.js`
  - **核心功能**:
    - 扩展现有spacing对象，添加响应式间距支持
    - 移动端紧凑间距: `mobile: { tabbar: '60px', padding: '12px', gap: '8px' }`
    - 平板端适中间距: `tablet: { sidebar: '200px', padding: '16px', gap: '12px' }`
    - 桌面端保持现有: `desktop: { sidebar: '240px', padding: '20px', gap: '16px' }`
    - 生成响应式CSS变量: `--spacing-mobile-tabbar`等
  - **技术要求**:
    - 向下兼容现有间距系统
    - 支持动态CSS变量生成
    - 提供JavaScript工具函数访问间距值
  - **验收标准**: 不同设备有合适的间距规范，CSS变量正常工作

- [ ] **任务3: 响应式CSS工具类库**
  - **文件位置**: `src/design-system/responsive.css`
  - **核心功能**:
    - 显示/隐藏工具类: `.hide-mobile`, `.hide-tablet`, `.hide-desktop`
    - 显示/隐藏工具类: `.show-mobile`, `.show-tablet`, `.show-desktop`
    - 响应式弹性布局: `.flex-mobile-column`, `.flex-desktop-row`
    - 响应式间距类: `.p-mobile-sm`, `.p-desktop-lg`
    - 响应式文字大小: `.text-mobile-sm`, `.text-desktop-base`
    - 移动端专用类: `.mobile-tabbar-height`, `.mobile-safe-area`
  - **技术要求**:
    - 基于断点系统的媒体查询
    - 与现有CSS架构无冲突
    - 支持CSS模块化和Tree-shaking
  - **验收标准**: 工具类在各断点正常显示/隐藏，样式生效无冲突

### 1.2 核心基础设施

- [ ] **任务4: 设备检测API**
  - **文件位置**: `src/composables/useDevice.js`
  - **核心功能**:
    - 响应式窗口监听: `const windowWidth = ref(window.innerWidth)`
    - 智能设备类型计算: `const deviceType = computed(() => ...)`
    - 布尔值便捷检测: `isMobile`, `isTablet`, `isDesktop`
    - 实时窗口变化监听: `window.addEventListener('resize', updateWidth)`
    - 设备方向检测: `orientation` (portrait/landscape)
    - 触摸能力检测: `isTouchDevice`, `hasHover`
    - 设备像素比检测: `pixelRatio`
  - **技术要求**:
    - 使用Vue 3 Composition API
    - 提供防抖处理避免频繁触发
    - 支持SSR环境兼容性
  - **验收标准**: 准确识别设备类型，实时响应窗口变化，性能良好

- [ ] **任务5: 响应式布局状态管理**
  - **文件位置**: `src/store/layout.js`
  - **核心功能**:
    - 设备状态管理: `deviceType`, `windowSize`
    - 侧栏状态控制: `leftSidebarCollapsed`, `rightSidebarCollapsed`
    - **移动端Tab状态**: `activeMobileTab` ('create', 'files', 'preview', 'terminal')
    - 全屏状态管理: `isFullScreen`, `fullScreenComponent`
    - 响应式布局动作: `adaptToDevice()`, `toggleSidebar()`, `switchMobileTab()`
    - 布局历史记录: 支持状态回退和恢复
  - **技术要求**:
    - 基于Pinia状态管理系统
    - 提供持久化存储支持
    - 支持状态变化的响应式监听
  - **验收标准**: 跨组件状态同步，设备切换时自动调整，状态持久化正常

- [ ] **任务6: 响应式混入工具集**
  - **文件位置**: `src/mixins/responsive.js`
  - **核心功能**:
    - 设备检测混入: `deviceMixin`
    - 响应式类名混入: `responsiveClassMixin`
    - 断点监听混入: `breakpointMixin`
    - 触摸事件混入: `touchMixin`
    - 常用计算属性: `responsiveClasses`, `deviceSpecificStyles`
    - 生命周期钩子: 自动处理resize和设备变化
  - **技术要求**:
    - 提供统一的响应式API接口
    - 支持选择性混入使用
    - 优化性能避免重复计算
  - **验收标准**: 减少组件内重复代码，提供一致的响应式API

---

## 📱 阶段2: 响应式容器开发

### 2.1 布局容器

- [ ] **任务7: 响应式主布局容器**
  - **文件位置**: `src/layouts/ResponsiveLayout.vue`
  - **核心功能**:
    - 模板结构: 根据`deviceType`条件渲染不同布局
    - 桌面端: `<DesktopLayout>` (保持现有四窗口)
    - 移动端: `<MobileLayout>` (全屏单窗口 + 底部Tab)
    - 平板端: `<TabletLayout>` (可折叠侧栏)
    - 设备切换动画: 使用Vue transition组件
    - CSS类绑定: 动态添加 `device-mobile`, `device-tablet`, `device-desktop`
    - 布局状态同步: 与layout store双向绑定
  - **技术要求**:
    - 无缝设备切换体验
    - 动画性能优化
    - 支持布局状态的路由级持久化
  - **验收标准**: 设备切换时布局正确切换，动画流畅，无布局抖动

- [ ] **任务8: 移动端底部导航栏**
  - **文件位置**: `src/components/mobile/TabNavigation.vue`
  - **核心功能**:
    - **四个Tab项**: 
      - 📝 **创建卡片** (create) - 对应PC端右边栏内容
      - 📁 **文件** (files) - 对应PC端左边栏内容  
      - 👁️ **预览** (preview) - 对应PC端中上区域内容
      - 💻 **Terminal** (terminal) - 对应PC端中下区域内容
    - Tab状态管理: 与store中`activeMobileTab`同步
    - 活跃指示器: 底部高亮条或背景色变化
    - 图标 + 文字标签: 符合移动端设计规范
    - 触摸反馈: 点击时有视觉和触觉反馈
    - 安全区域适配: 考虑iPhone等设备的底部安全区域
    - 徽章系统: 支持消息数量等状态指示
  - **技术要求**:
    - 固定定位确保始终可见
    - 支持左右滑动切换
    - 适配不同屏幕尺寸和安全区域
  - **验收标准**: 导航栏固定底部，Tab切换准确，功能映射正确

### 2.2 视图容器

- [ ] **任务9: 移动端视图切换容器**
  - **文件位置**: `src/components/mobile/MobileViewContainer.vue`
  - **核心功能**:
    - 全屏视图容器: `height: calc(100vh - 60px)` (减去TabBar高度)
    - **视图组件映射**: 
      - create -> `MobileCreateView` (模板选择和输入界面)
      - files -> `MobileFilesView` (卡片文件列表)
      - preview -> `MobilePreviewView` (预览显示区域)
      - terminal -> `MobileTerminalView` (终端交互界面)
    - 切换动画: 左右滑动过渡效果 (slide-left, slide-right)
    - 滑动手势支持: 左右滑动切换Tab
    - 返回栈管理: 记录视图访问历史，支持返回上一视图
    - Loading状态: 视图切换时的加载指示
    - 缓存机制: 避免频繁重新渲染已访问视图
  - **技术要求**:
    - 手势识别准确性和流畅度
    - 视图缓存策略优化
    - 支持嵌套路由和深层链接
  - **验收标准**: 视图切换动画流畅，支持手势操作，缓存策略有效

- [ ] **任务10: 抽屉式侧边栏(平板端)**
  - **文件位置**: `src/components/layout/DrawerSidebar.vue`
  - **核心功能**:
    - 左侧抽屉: 卡片文件列表 (宽度200px)
    - 右侧抽屉: 创建卡片和模板选择 (宽度280px)
    - 展开/收起动画: `transform: translateX()` + `transition`
    - 遮罩层: 打开时显示半透明背景，点击关闭
    - 手势支持: 从边缘滑动打开抽屉
    - 状态持久化: 记住用户的展开偏好
    - 响应式宽度: 根据平板尺寸动态调整抽屉宽度
  - **技术要求**:
    - 边缘检测手势识别
    - 动画性能优化
    - z-index层级管理
  - **验收标准**: 平板端抽屉可正常展开收起，不影响主内容区域

---

## 🎨 阶段3: 组件响应式适配

### 3.1 主要业务组件改造

- [ ] **任务11: CardGenerator响应式改造**
  - **改造文件**: `src/views/CardGenerator.vue`
  - **改造策略**:
    - **保持现有逻辑不变**: 所有script部分、业务逻辑、状态管理完全保留
    - **模板条件渲染**: 根据设备类型条件渲染不同布局结构
    - **CSS响应式规则**: 使用媒体查询为不同设备定义样式
  - **具体实现**:
    ```vue
    <template>
      <div class="card-generator" :class="deviceClass">
        <!-- 桌面端: 保持现有四窗口布局 -->
        <template v-if="isDesktop">
          <!-- 现有的 left-sidebar(卡片列表), main-area(预览+终端), right-sidebar(创建+模板) -->
        </template>
        
        <!-- 移动端: 全屏单窗口 + Tab切换 -->
        <template v-else-if="isMobile">
          <MobileViewContainer>
            <MobileCreateView v-show="activeTab === 'create'" />
            <MobileFilesView v-show="activeTab === 'files'" />  
            <MobilePreviewView v-show="activeTab === 'preview'" />
            <MobileTerminalView v-show="activeTab === 'terminal'" />
          </MobileViewContainer>
          <TabNavigation />
        </template>
        
        <!-- 平板端: 可折叠侧栏布局 -->
        <template v-else>
          <TabletCardGeneratorView :collapsed="sidebarCollapsed" />
        </template>
      </div>
    </template>
    ```
  - **CSS策略**:
    - 桌面端(≥1024px): 保持现有flex布局和固定宽度
    - 平板端(768px-1023px): 侧栏可折叠，主区域自适应
    - 移动端(<768px): 全屏单视图，隐藏所有侧栏
  - **验收标准**: 各设备功能完全一致，无业务逻辑改动，UI适配流畅

- [ ] **任务12: 移动端创建卡片视图**
  - **新建组件**: `src/components/mobile/MobileCreateView.vue`
  - **核心功能**:
    - **对应PC端右边栏功能**: 模板选择、主题输入、参数配置
    - 模板库浏览: 支持触摸滚动的模板卡片列表
    - 主题输入优化: 大号输入框，支持语音输入
    - 参数配置: 移动端友好的表单控件
    - 快速操作: 一键生成、保存草稿等快捷功能
    - 模板预览: 支持全屏预览模板效果
  - **技术要求**:
    - 表单输入移动端优化
    - 模板数据与PC端完全同步
    - 支持离线草稿保存
  - **验收标准**: 创建卡片功能与PC端完全一致，操作流畅

- [ ] **任务13: 移动端文件列表视图**
  - **新建组件**: `src/components/mobile/MobileFilesView.vue`
  - **核心功能**:
    - **对应PC端左边栏功能**: 卡片文件管理和浏览
    - 卡片项触摸优化: 增大点击区域至44px，符合设计规范
    - 滑动删除交互: 左滑显示删除按钮，支持滑动阈值控制
    - 长按菜单: 长按显示"重命名、删除、复制、分享"等操作
    - 下拉刷新: 顶部下拉刷新卡片列表，显示加载动画
    - 无限滚动: 虚拟滚动和分页加载优化
    - 搜索优化: 移动端搜索框，支持语音输入和历史记录
    - 文件夹管理: 支持创建文件夹和拖拽整理
  - **技术要求**:
    - 触摸手势识别准确
    - 虚拟滚动性能优化
    - 搜索防抖和结果缓存
  - **验收标准**: 文件管理功能完整，触摸交互流畅

- [ ] **任务14: 移动端预览视图**
  - **新建组件**: `src/components/mobile/MobilePreviewView.vue`
  - **核心功能**:
    - **对应PC端中上区域功能**: 卡片内容预览显示
    - 全屏预览模式: 沉浸式预览体验
    - 缩放和滚动: 双指缩放、触摸滚动查看详细内容
    - 左右滑动切换: 滑动浏览不同卡片文件
    - 工具栏: 分享、编辑、全屏等快捷操作
    - 预览格式支持: Markdown、JSON、图片等多格式
    - 离线预览: 支持离线查看已缓存的内容
  - **技术要求**:
    - 多格式渲染引擎
    - 缩放和手势优化
    - 内容缓存策略
  - **验收标准**: 预览功能完整，手势操作自然

- [ ] **任务15: 移动端终端视图**
  - **新建组件**: `src/components/mobile/MobileTerminalView.vue`
  - **核心功能**:
    - **对应PC端中下区域功能**: 命令行终端交互
    - 移动端全屏模式: 点击进入沉浸式全屏终端视图
    - 虚拟键盘适配: 键盘弹出时调整终端高度，避免内容遮挡
    - 触摸滚动优化: 支持触摸滚动查看历史输出，惯性滚动
    - 字体大小适配: 移动端增大字体以便阅读，支持用户自定义
    - 快捷按钮栏: 添加常用命令的快捷按钮 (Tab, Ctrl+C, 方向键等)
    - 复制粘贴优化: 长按选择文本，支持复制粘贴，剪贴板集成
    - 横屏优化: 横屏时提供更好的终端体验，更大的显示区域
    - 命令历史: 上滑查看命令历史，支持快速重新执行
  - **技术要求**:
    - 虚拟键盘事件处理
    - 触摸手势与终端交互的协调
    - 文本选择和剪贴板API
  - **验收标准**: 移动端终端可正常使用，输入输出无问题，体验流畅

---

## ✋ 阶段4: 触摸交互优化

### 4.1 手势支持

- [ ] **任务16: 触摸手势API库**
  - **文件位置**: `src/composables/useTouch.js`
  - **核心功能**:
    - 基础手势事件: `onTouchStart`, `onTouchMove`, `onTouchEnd`
    - 方向滑动检测: 左滑、右滑、上滑、下滑，支持阈值配置
    - 长按检测: `longPress` (默认500ms，可配置)
    - 双击检测: `doubleTap` (300ms内两次点击)
    - 捏合缩放: `pinchZoom` (两指缩放手势)
    - 滑动距离计算: 计算滑动距离、速度和方向
    - 防抖处理: 避免重复触发和误触
    - 默认行为控制: 在需要时阻止浏览器默认行为
    - 手势冲突解决: 处理多种手势的优先级
  - **技术要求**:
    - 高精度触摸点计算
    - 性能优化避免卡顿
    - 跨平台兼容性
  - **验收标准**: 手势识别准确，无误触，性能良好

- [ ] **任务17: Tab切换滑动功能**
  - **应用场景**: 底部Tab导航、视图切换
  - **核心功能**:
    - **Tab导航切换**: 左右滑动切换创建→文件→预览→终端
    - 滑动阈值控制: 滑动距离>50px才触发切换，可配置
    - 跟随手指动画: 跟随手指的实时滑动动画效果
    - 回弹效果: 滑动距离不足时的弹性回弹动画
    - 惯性滚动: 快速滑动时的惯性继续滚动效果
    - 边界处理: 到达边界时的视觉反馈
    - 循环切换: 支持从终端滑动到创建(可选)
  - **技术要求**:
    - 动画帧优化
    - 物理引擎集成
    - Tab状态同步
  - **验收标准**: 滑动切换流畅自然，符合移动端操作习惯

- [ ] **任务18: 移动端上下文菜单系统**
  - **触发方式**: 长按显示智能上下文操作菜单
  - **核心功能**:
    - **创建视图菜单**: 选择模板、导入模板、模板收藏等
    - **文件视图菜单**: 重命名、删除、复制、移动、分享等操作
    - **预览视图菜单**: 编辑、分享、导出、收藏等操作
    - **终端视图菜单**: 复制输出、清空屏幕、保存日志等操作
    - 菜单智能定位: 根据长按位置和屏幕空间智能定位菜单
    - 菜单样式系统: 符合移动端设计规范的弹出菜单样式
    - 菜单消失机制: 点击其他区域或执行操作后自动消失
    - 触觉反馈: 长按时提供触觉反馈 (Haptic Feedback)
  - **技术要求**:
    - 菜单定位算法
    - 触觉反馈API
    - 动态权限检查
  - **验收标准**: 菜单定位准确，操作便捷，功能覆盖完整

---

## 🔧 阶段5: 优化与完善

### 5.1 性能优化

- [ ] **任务19: 代码分割与懒加载优化**
  - **优化方向**: 移动端组件按需加载，减少初始包体积
  - **核心功能**:
    - 路由级代码分割: 移动端组件使用`import()`动态导入
    - 组件级精细分割: 大型组件 (如图表、编辑器) 按需加载
    - 依赖分析优化: 使用webpack-bundle-analyzer分析包大小
    - Tree-shaking增强: 确保未使用的代码被正确移除
    - 预加载策略: 对即将使用的组件进行智能预加载
    - 缓存策略优化: 合理设置组件和资源缓存
    - Service Worker: 实现离线缓存和后台更新
  - **技术要求**:
    - Vite构建优化配置
    - 模块联邦支持
    - 缓存策略设计
  - **验收标准**: 移动端首屏加载时间显著提升，包体积增长<20%

- [ ] **任务20: 响应式图片处理系统**
  - **优化内容**: 根据设备密度和尺寸加载合适的图片
  - **核心功能**:
    - 响应式图片: 使用`srcset`和`sizes`属性提供多种尺寸
    - 设备像素比适配: 为Retina屏幕提供@2x和@3x高清图片
    - 懒加载实现: 图片进入视窗时才加载，支持占位符
    - 现代格式支持: 优先使用WebP/AVIF，fallback到JPG/PNG
    - 图片自动压缩: 构建时自动压缩图片以减少体积
    - 占位符系统: 图片加载时显示低质量占位符或骨架屏
    - 错误处理机制: 图片加载失败时的优雅降级方案
    - 进度指示: 大图片加载时显示加载进度
  - **技术要求**:
    - 图片处理管道
    - CDN集成支持
    - 格式检测和降级
  - **验收标准**: 不同设备显示清晰，加载速度快，体验流畅

### 5.2 用户体验

- [ ] **任务21: Loading状态与反馈优化**
  - **优化方向**: 减少用户等待焦虑，提升感知性能
  - **核心功能**:
    - 骨架屏系统: 为卡片列表、预览等区域添加结构化骨架屏
    - 统一加载动画: 统一的Loading spinner和进度条设计
    - 渐进式加载: 先显示基础内容框架，再逐步加载详细信息
    - 智能预加载: 预测用户行为，提前加载可能需要的资源
    - 加载状态管理: 明确的加载、成功、失败、重试状态
    - 重试机制: 加载失败时提供用户友好的重试选项
    - 时间预估: 对于耗时操作显示预估完成时间
    - 后台加载: 支持后台静默加载和更新
  - **技术要求**:
    - 状态机设计模式
    - 预测算法实现
    - 后台任务管理
  - **验收标准**: 加载过程体验良好，用户不会感到无响应

- [ ] **任务22: 响应式测试与调优**
  - **测试方法**: 多设备、多浏览器、多场景全面测试
  - **核心功能**:
    - 真机设备测试: iPhone、Android、iPad等主流设备测试
    - 浏览器兼容性: Safari、Chrome、Firefox、Edge兼容性验证
    - 断点边界测试: 在各个断点边界值测试布局稳定性
    - 性能基准测试: Lighthouse评分，First Paint、FCP、LCP等关键指标
    - 交互体验测试: 触摸、滑动、长按等手势响应测试
    - 无障碍测试: 屏幕阅读器、键盘导航等无障碍功能验证
    - 边缘情况测试: 极长文本、网络缓慢、低内存等边缘情况
    - 回归测试: 确保新功能不影响现有功能的稳定性
  - **技术要求**:
    - 自动化测试脚本
    - 性能监控系统
    - 无障碍测试工具
  - **验收标准**: 各设备体验一致，性能达标，无明显Bug或兼容性问题

---

## 🎯 验收标准

### 功能验收
- [ ] PC端体验完全不变 (100%向下兼容)
- [ ] 移动端四个Tab功能与PC端区域完全对应
- [ ] 平板端界面适配良好 (无横向滚动)
- [ ] 设备切换响应及时 (布局切换流畅)

### 移动端功能对应验收
- [ ] 📝 创建卡片Tab = PC端右边栏功能 (模板选择、输入配置)
- [ ] 📁 文件Tab = PC端左边栏功能 (卡片列表、文件管理)  
- [ ] 👁️ 预览Tab = PC端中上区域功能 (内容预览显示)
- [ ] 💻 Terminal Tab = PC端中下区域功能 (命令行交互)

### 性能验收
- [ ] 构建包体积增加 <20%
- [ ] 移动端首屏加载时间 <3秒
- [ ] 响应式切换流畅 (无卡顿)
- [ ] 触摸响应时间 <100ms

### 兼容性验收
- [ ] iOS Safari 完全支持
- [ ] Android Chrome 完全支持
- [ ] 现代桌面浏览器支持
- [ ] 优雅降级方案可用

---

## 🛠️ 开发工具

### 必需工具
- **Vite DevTools**: 响应式调试
- **Vue DevTools**: 组件状态检查
- **Browser DevTools**: 设备模拟测试
- **Lighthouse**: 性能评分

### 推荐插件
- **Vue Language Tools**: VS Code支持
- **Tailwind CSS IntelliSense**: CSS类提示 (如果使用)
- **ES6+ Snippets**: 开发效率提升

---

## 🚀 开始第一步

准备从任务1开始：

```bash
# 1. 创建开发分支
git checkout -b feature/responsive-design

# 2. 创建必要目录
mkdir -p src/design-system/tokens
mkdir -p src/composables
mkdir -p src/store
mkdir -p src/components/mobile
mkdir -p src/layouts

# 3. 开始任务1: 断点系统设计
touch src/design-system/tokens/breakpoints.js
```

**按照任务顺序逐个完成，每完成一个任务都进行测试验证！** 🎯